# 要件文書

## 概要

CycleFog Connectは、サイクリストのための走行ルート可視化とグループライドマッチングアプリです。Fog of World型の地図可視化により未踏エリアを明確にし、グループライド機能で仲間との連携を促進することで、サイクリングの継続意欲を喚起します。対象地域はドイツ・フランス・オランダの欧州三地域です。

## 要件

### 要件1：走行ログとFogマップ機能

**ユーザーストーリー:** サイクリストとして、自分の走行履歴を視覚的に確認し、未踏エリアを発見できるようにしたい。これにより新しいルートへの探索意欲を高めたい。

#### 受入基準

1. WHEN ユーザーがGPSログをアップロードする THEN システムは走行ルートを地図上に塗りつぶし表示する
2. WHEN ユーザーが地図を表示する THEN システムは未走行エリアを明確に区別して表示する
3. WHEN ユーザーがタイル単位の進捗を確認する THEN システムはタイル毎の走行状況を可視化する
4. IF GPSログに不正なデータが含まれる THEN システムはエラーメッセージを表示し、有効な部分のみを処理する

### 要件2：グループライドマッチング機能

**ユーザーストーリー:** サイクリストとして、同じ地域の仲間とライドを企画・参加できるようにしたい。これにより安全で楽しいグループライドを実現したい。

#### 受入基準

1. WHEN ユーザーがライドを募集する THEN システムは地域、日時、難易度を指定できる投稿フォームを提供する
2. WHEN 他のユーザーがライド募集を検索する THEN システムは地域と日時でフィルタリングされた結果を表示する
3. WHEN ユーザーがライドに参加希望を出す THEN システムは募集者に通知を送信する
4. WHEN 募集者が参加者を承認する THEN システムは参加者に確認通知を送信する
5. IF ライド開催日時が過ぎた THEN システムは自動的に募集を終了する

### 要件3：チャレンジ機能

**ユーザーストーリー:** サイクリストとして、個人やグループで目標を設定し、達成感を得られるようにしたい。これにより継続的なモチベーションを維持したい。

#### 受入基準

1. WHEN ユーザーが個人チャレンジを作成する THEN システムは未踏エリア制覇や走行距離目標を設定できる
2. WHEN ユーザーがグループチャレンジを作成する THEN システムは複数人での共同目標設定を可能にする
3. WHEN チャレンジの進捗が更新される THEN システムはリアルタイムで達成率を表示する
4. WHEN チャレンジが達成される THEN システムは達成通知とバッジを付与する
5. IF チャレンジ期限が過ぎた THEN システムは結果を集計し、参加者に結果を通知する

### 要件4：モチベーション維持通知機能

**ユーザーストーリー:** サイクリストとして、未踏エリアの近くを通過した際に気づきを得られるようにしたい。これにより新しいルートへの探索を促進したい。

#### 受入基準

1. WHEN ユーザーが未踏エリアの近く（500m以内）を通過する THEN システムは「この辺り、まだ走ってない？」という通知を送信する
2. WHEN 通知が送信される THEN システムは現在地から未踏エリアへの推奨ルートを提案する
3. IF ユーザーが通知設定をオフにしている THEN システムは通知を送信しない
4. WHEN ユーザーが通知をタップする THEN システムは該当エリアの詳細マップを表示する

### 要件5：安全・ナビサポート機能

**ユーザーストーリー:** グループライド参加者として、仲間の位置を把握し、安全に走行できるようにしたい。これにより安心してグループライドを楽しみたい。

#### 受入基準

1. WHEN グループライドが開始される THEN システムは参加者間でリアルタイム位置共有を開始する
2. WHEN 参加者が危険箇所に近づく THEN システムは安全注意アラートを表示する
3. WHEN 参加者が一定距離（1km以上）離れる THEN システムは他の参加者に通知する
4. IF GPSシグナルが不安定になる THEN システムは最後の有効位置を表示し続ける
5. WHEN グループライドが終了する THEN システムは位置共有を自動的に停止する

### 要件6：地域対応機能

**ユーザーストーリー:** ドイツ・フランス・オランダのサイクリストとして、自分の地域に最適化されたサービスを利用したい。これにより地域特性に合った体験を得たい。

#### 受入基準

1. WHEN ユーザーが地域を選択する THEN システムはドイツ・フランス・オランダの地図データを提供する
2. WHEN ユーザーがアプリを使用する THEN システムは選択された地域の言語（ドイツ語・フランス語・オランダ語・英語）で表示する
3. WHEN 地域固有の交通ルールがある THEN システムは該当地域のサイクリング規則に基づいた安全情報を提供する
4. IF ユーザーが対象地域外にいる THEN システムは機能制限について通知する

### 要件7：ユーザー認証とプロフィール管理

**ユーザーストーリー:** サイクリストとして、個人の走行データを安全に管理し、他のユーザーと適切に交流できるようにしたい。

#### 受入基準

1. WHEN ユーザーがアカウントを作成する THEN システムはメールアドレスとパスワードによる認証を提供する
2. WHEN ユーザーがプロフィールを設定する THEN システムはサイクリングレベル（レジャー/レーサー）と居住地域の選択を可能にする
3. WHEN ユーザーが他のユーザーを検索する THEN システムは公開プロフィール情報のみを表示する
4. IF 不適切な行動が報告される THEN システムは管理者による審査機能を提供する
5. WHEN ユーザーがデータ削除を要求する THEN システムは個人データを完全に削除する機能を提供する